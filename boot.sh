#!/bin/bash

ascii_logo='
                                                  &&&&&&&&&                                                  
                                        &&&&&&X;;;;: ;;;&&&&&&&&&&&&&                                        
                                   &&&&  ;;;;;;;;;   ;;&&&&&&&&&X;;;;;&&&&                                   
                               &&& :      ;;;;;;;;;    &&&&&&&&;;;;;;;;;;;;&&&                               
                           &&&  ;;;;        :::;;;   ;x&&&&&&;;;;;;;;;;;;;;;;;;&&&                           
                         &&&   ;;;;;;       ;;;;;    ;&&&&&&X;;;;;;;;;;;;;;;;;;;;;&&                         
                      &&&&&&  ;;; :;;;   ;;;;;;;;;;;;;&&&&&&;;;;;;;;;;;;;;;;;;;;;;;;X&&                      
                    &&&&&&&& ;;   ;;;;  ;;;;;;;;;;;;;;&&&&&;;;;;;;;;;;;;;;;;;;;;;;;;;;;&&                    
                  &&&&&&&&&&        ;;;;;;;;;;;;;;;;;;&&&&&;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;&&                  
                &&   &&&&&&&&     ;;;;;;;;;;;;;;;;;;;;&&&&;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;&&                
               &&     &&&&&&&       ;;;;;;;;;;;;;;;;;;&&&&;;;  ;;  ;;;;;;;;;   ;;;;;;;;;;;;;X&               
             &&        &&&&&&&      ;;;;;;;; ;;: ;;;;;&&&;;;        ;;;;;;;:  ;;;;;;;;;;&&&&&&&&             
            &&           &&&&&&;;;;;;;;:    ; ;;;:  ;;&&&;;;    ;:     ;;;;;   ;;;;;;;&&&&&&&&&&&            
          &&              &&&&&&;;;;;       ;    ;;; ;&&& ;;;;;;;;;;;;;;;;;;;;  ;;;$&&&&&&&&&&&&&&           
         &&                 &&&&&;;;;             ;   &&x ;;;;;;;;;;;;;;;;;;;    &&&&&&&&&&&&&&&&&&&         
        &&                    &&&&$  ;;;;;;;;;        && : : ; ;;;:;;;;;;;;;;;;&&&&&&&&&;;;;;;;;;;;&&        
       &&                      x&&&&;;;;;;;;;;        &&        ;  ;;;;;;;;;;&&&&&&&;;;;;;;;;;;;;;;;&        
       &                     ;;;;&&&&;;;;;;;;;;;      &&          ;;;;;;;;;&&&&&&;;;;;;;;;;;;;;;;;;;;&       
      &&                    ;;;;;;;&&&;;;;;;;;;;;;;;  &&;;;;; ;;;;;;;;;;;&&&&&;;;;;;;;;;;;;;;;;;;;;;;X&      
     &&                    ;;;;;;;;;;&&&;;;;;;;;;;;;;;&$;;;;;;;;;;;;;;;X&&&;;;  ;;;;;;;;;;;;;;;;;;;;;;&&     
     &                   ;;;;;;;;;;;;;;&&;;;;;;;;;;;;;&;;;;;;;;;;; ;;;&&&;;;;;;   ;;;;;;;;;;;;;;;;;;;;;&     
    &&                 :;;;;;;;;;;;;;;;;;&&;;;;;;;;;;;&;;;;;;;;;;;; &&;;;;;;;;;;;   ; ;;;;;;;;;;;;;;;;;&&    
    &                 ;;;;;;;;;;;;;;;;;;;;;&;;;;;;;;;;$;;;;;;;;;;;&&  ;;;;;;;;;;;;;;;;;        ;;;;;;;;;&    
   &&&&              ;;;;;;;;;;;;;;;;;;;;;;;;&;;;;;;;;+;;;;;;;;;&$;;; ;;;;;;;;;;;;;;;;;;;        ;;;;;;;&&   
   &&&&&&             ;;;;;;;;;;;;;;;;;;;;;;;;&;;+XXXXXXXX&;;;+;;;;;;  :;;;;;;;;;;;;;;;             ;;;;&&   
   &&&&&&&&&          ;;;;;;;;;;;;;;;;;;;;;;;;;&XXXXXXXXXXXXX;;;;;;;;;   ;;;;;;;;;;;;;              ;;;;;&   
   &&&&&&&&&&&&&&&    ;;;;;;;;;;;;;;;;;;;;;;;;$XXXXXXXXXXXXXXX;;;;;;;;;   ;;;;;;;;;                  ;;;;&   
  &&&&&&&&&&&&&&&&&&&&&&&&x;;;;;;;;;;;;;;;;;;$XXXXXXXXXXXXXXXXX;;;;;;;;;; ;;;;;;                      ;;;&   
  &&   &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$XXXXXXXXXXXXXXXXX;;;;;;;;;;;;;                          ;;;&   
  &&                   ;;;;;;;;;;;;;;;;;;;;;;&XXXXXXXXXXXXXXXXX+$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&X;&   
   &                    ;;;;;;;;;;;;;;;;;;;;;;XXXXXXXXXXXXXXXXx;;;;;;;;;;;;;;;;;;    &&&&&&&&&&&&&&&&&&&&&   
   &                     ;;;;;;;;;;;;;;;;;;;;;;XXXXXXXXXXXXXXx;;;;;;;;;;;;;;;;;;;            &&&&&&&&&&&&&   
   &&                      ;;;;;;;;;     ;;;;;&;;XXXXXXXXXX&;;;;;;;;;;;;;;;;;;;;                  &&&&&&&&   
   &&                                       &;;;;;;;;&&x;;;;;&;;;;;;;;;;;;;;;;                       &&&&&   
    &                                     && ;;;;;;;;x;;;;;;;;;&;;;;;;;;;;;;;                          &&    
    &&                                  &&  ;;;;;;;;;$;;;;;;;;;;;&;;;;;;;;;                            &&    
     &                               &&&    ;;;;;;;;;&;;;;;;;;;;; &&;;;;;                              &     
     &&                            &&&        ;;;;;;;&;;;;;;;;;;;;;;&&;;                              &&     
      &&                        &&&&&          ;;;;;;&+;;;;;;;;;;;;;;&&&                             &&      
       &                     &&&&&&            :;;;;;&X;;;;;;;;;;;;;;;;&&&                           &       
       &&                 &&&&&&&               ;;;;;&$;;;;;;;;;;;;;;;;;&&&&                        &        
        &&             &&&&&&&&                 ;;;;x&&;;;;;;;;;;;;;;;;; &&&&&                     &&        
         &&&      &&&&&&&&&&&                   ;;;;&&&;;;;;;;;;;;;;;;;;  &&&&&&                  &&         
          &&&&&&&&&&&&&&&&&                    ;;;;;&&&;;;;;;;;;;;;;;;;;    &&&&&&               &           
            &&&&&&&&&&&&&                     :;;;;;&&&;;;;;;;;;;;;;;;;;   ;;&&&&&&            &&            
             &&&&&&&&&                        ;;;;;&&&&;;;;;;;;;;;;;;      ;;;&&&&&&&         &&             
               &&&&&                            ;;;&&&&;;;;;;;;;;;;        ;;;;&&&&&&&      &&               
                &&                              ;;;&&&&;;;;;;;;;;;;       ;;;;  &&&&&&&    &&                
                  &&                             ;&&&&&;;;;;;;;;;;;       ;;;;  &&&&&&&& &&                  
                    &&                           ;&&&&&;;;;;;;;;;          ;     &&&&&&&&                    
                      &&&                        &&&&&$;;;;;;;;;;                &&&&&&                      
                         &&                     &&&&&&+;;;;;;;;;                &&&&                         
                           &&&&                &&&&&&&;;;;;;;;;               &&&&                           
                               &&&            &&&&&&&&;;;;;;;              &&&                               
                                   &&&&     &&&&&&&&&&                &&&&                                   
                                        &&&&&&&&&&&&&        &&&&&&&&                                        
                                                  &&&&&&&&&                                                  
'

clear

echo -e "\n$ascii_logo\n"
echo -e "\033[1;37mWelcome agent, please enter your password to begin the installation process.\033[0m"
sudo pacman -Syu --noconfirm --needed git >/dev/null
rm -rf ~/.local/share/labs/

sleep 2
echo -e "\n\033[1;32m[SUCCESS] Agent authentication successful.\033[0m"
sleep 1
echo -e "\n\033[1;34m[INFO] Initializing secure communication protocols...\033[0m"
sleep 1
echo -e "\n\033[1;34m[INFO] Establishing encrypted connection...\033[0m"
sleep 4

clear

REPOSITORY_REF="${REPOSITORY_REF:-main}"
REPOSITORY_NAME="${REPOSITORY_NAME:-labs}"
REPOSITORY_AUTHOR="${REPOSITORY_AUTHOR:-noxtgm}"

echo -e "\033[1;34m[INFO] Retrieving system components from:\033[0m https://github.com/${REPOSITORY_AUTHOR}/${REPOSITORY_NAME}.git"
git clone "https://github.com/${REPOSITORY_AUTHOR}/${REPOSITORY_NAME}.git" ~/.local/share/labs >/dev/null

if [[ $REPOSITORY_REF != "main" ]]; then
    echo -e "\033[1;34m[INFO] Switching to operational branch:\033[0m $REPOSITORY_REF"
    cd ~/.local/share/labs
    git fetch origin "${REPOSITORY_REF}" && git checkout "${REPOSITORY_REF}"
    cd -
fi

echo -e "\033[1;32m[SUCCESS] Repository secured. Beginning system deployment...\033[0m"

clear

echo -e "\033[1;33m[WARNING] This system contains classified information. Unauthorized access is prohibited.\033[0m"

sleep 4

source ~/.local/share/labs/install.sh
